import{N as e,E as n,r as a,_ as i,O as t,j as l,ak as r,m as o,g as s,i as u,P as c,l as v,a4 as d,D as f,Y as k,c as m,d as p,e as w,p as h,u as b,S as _,J as S,K as g}from"./index-73415115.js";import{a as C,u as x,b as V}from"./useWaitTransitionFinish-8d23fc7b.js";import{g as B}from"./getNavId-aa412334.js";import{c as E,P as y}from"./App-71662d86.js";import{P as O}from"./PanelHeaderButton-a05aa34b.js";var N=e("Icon28ArrowLeftOutline","arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_left_outline_28"><g fill="none" fill-rule="evenodd"><path d="M28 0H0v28h28z" /><path fill="currentColor" fill-rule="nonzero" d="M12.293 6.293a1 1 0 0 1 1.414 1.414L8.414 13H22a1 1 0 0 1 .993.883L23 14a1 1 0 0 1-1 1H8.414l5.293 5.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.414 0l-7-7-.073-.082A1.005 1.005 0 0 1 5 14l.004.09A1.006 1.006 0 0 1 5 14.02V14a1.02 1.02 0 0 1 .125-.484.878.878 0 0 1 .071-.111.999.999 0 0 1 .097-.112l-.08.09c.025-.031.051-.062.08-.09Z" /></g></symbol>',28,28,!1,void 0),P=e("Icon28ChevronBack","chevron_back_28","0 0 20 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 28" id="chevron_back_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v28H0z" /><path fill="currentColor" d="M4.56 12.94 13 4.5a1.414 1.414 0 0 1 2 2L7.5 14l7.5 7.5a1.414 1.414 0 0 1-2 2l-8.44-8.44a1.5 1.5 0 0 1 0-2.12Z" /></g></symbol>',20,28,!1,void 0),I=e("Icon28ChevronLeftOutline","chevron_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="chevron_left_outline_28"><path fill="currentColor" d="m12.414 14 5.793-5.793a1 1 0 0 0-1.414-1.414l-6.5 6.5a1 1 0 0 0 0 1.414l6.5 6.5a1 1 0 0 0 1.414-1.414z" /></symbol>',28,28,!1,void 0),W=a.createContext({entering:!1}),M=function(e){var i=e.children,t=e.entering,l=a.useContext(W),r=n({entering:l.entering||t});return a.createElement(W.Provider,{value:r},i)};var T,X;(X=T||(T={}))[X.fail=1]="fail",X[X.success=2]="success";var H={},j=function(e){var n,b,_=e.activePanel,S=e.history,g=e.nav,y=e.onTransition,O=e.onSwipeBack,N=e.onSwipeBackStart,P=e.onSwipeBackCancel,I=e.children,W=e.className,X=i(e,["activePanel","history","nav","onTransition","onSwipeBack","onSwipeBackStart","onSwipeBackCancel","children","className"]),j=a.useRef(H[B({nav:g,id:X.id})]||{}),A=a.useRef(t);a.useEffect((function(){return function(){var e=B({nav:g,id:X.id});e&&(H[e]=j.current)}}));var z=a.useRef({}),K=l(),L=K.window,R=K.document,F=r(),Z=o(),D=E(),J=s(),Y=u(a.useState(!1),2),q=Y[0],G=Y[1],Q=u(a.useState([_]),2),U=Q[0],$=Q[1],ee=u(a.useState(_),2),ne=ee[0],ae=ee[1],ie=u(a.useState(void 0),2),te=ie[0],le=ie[1],re=u(a.useState(null),2),oe=re[0],se=re[1],ue=u(a.useState(null),2),ce=ue[0],ve=ue[1],de=u(a.useState(!1),2),fe=de[0],ke=de[1],me=u(a.useState(!1),2),pe=me[0],we=me[1],he=u(a.useState(0),2),be=he[0],_e=he[1],Se=u(a.useState(0),2),ge=Se[0],Ce=Se[1],xe=u(a.useState(null),2),Ve=xe[0],Be=xe[1],Ee=u(a.useState(null),2),ye=Ee[0],Oe=Ee[1],Ne=u(a.useState(null),2),Pe=Ne[0],Ie=Ne[1],We=u(a.useState(!1),2),Me=We[0],Te=We[1],Xe=C(_),He=C(fe),je=C(Me),Ae=C(Pe),ze=C(ye),Ke=C(y),Le=a.Children.toArray(I).filter((function(e){var n=B(e.props);return void 0!==n&&U.includes(n)||n===ye||n===Ve})),Re=!1===(null===(n=Z)||void 0===n?void 0:n.transitionMotionEnabled)||!(null===(b=D)||void 0===b?void 0:b.animate)||J===c.VKCOM,Fe=function(e){return null===e?null:z.current[e]},Ze=a.useCallback((function(e,n){n&&(j.current[e]=0),se(null),ve(null),$([_]),ae(_),G(!1),le(void 0),A.current=function(){var a;null===(a=F)||void 0===a||a.scrollTo(0,n?j.current[_]:0),y&&y({isBack:n,from:e,to:_})}}),[_,y,F]);v((function(){A.current(),A.current=t}),[A.current]);var De=a.useCallback((function(e){e&&!["vkuivkui-animation-ios-next-forward","vkuivkui-animation-ios-prev-back","vkuivkui-animation-view-next-forward","vkuivkui-animation-view-prev-back"].includes(e.animationName)||null===oe||Ze(oe,Boolean(te))}),[Ze,te,oe]),Je=x().waitTransitionFinish,Ye=d(De,J===c.IOS?600:300),qe=a.useCallback((function(){O&&O()}),[O]),Ge=a.useCallback((function(){P&&P(),Oe(null),Be(null),ke(!1),Ie(null),_e(0),Ce(0)}),[P]),Qe=a.useCallback((function(e){var n,a;if(!e||(null===(n=e)||void 0===n?void 0:n.propertyName.includes("transform"))&&(null===(a=e)||void 0===a?void 0:a.target)===Fe(Ve))switch(Pe){case T.fail:Ge();break;case T.success:qe()}}),[Ge,qe,Ve,Pe]),Ue=a.useCallback((function(e){if(fe){var n,a=ge/e.duration*1e3;0===ge?Ge():ge>=(null!==(n=L.innerWidth)&&void 0!==n?n:0)?qe():a>250||be+ge>L.innerWidth/2?Ie(T.success):Ie(T.fail)}pe&&we(!1)}),[Ge,qe,ge,be,fe,pe,L]),$e=function(e){if(!h||!L)return{};var n=e===ye,a=e===Ve;if(!n&&!a||Pe)return{};var i="".concat(ge,"px"),t="".concat(100*ge/L.innerWidth/2-50,"%"),l=.3*(L.innerWidth-ge)/L.innerWidth;return Pe?n?{boxShadow:"-2px 0 12px rgba(0, 0, 0, ".concat(l,")")}:{}:a?{transform:"translate3d(".concat(t,", 0, 0)"),WebkitTransform:"translate3d(".concat(t,", 0, 0)")}:n?{transform:"translate3d(".concat(i,", 0, 0)"),WebkitTransform:"translate3d(".concat(i,", 0, 0)"),boxShadow:"-2px 0 12px rgba(0, 0, 0, ".concat(l,")")}:{}};return a.useEffect((function(){if(Xe&&Xe!==_&&!He&&!je){var e,n=a.Children.toArray(I).map((function(e){return B(e.props)})).find((function(e){return e===Xe||e===_}))===_;j.current[Xe]=null===(e=F)||void 0===e?void 0:e.getScroll().y,Re?Ze(Xe,n):(f(R),$([Xe,_]),se(Xe),ve(_),ae(null),G(!0),le(n),V.supported||Ye.set())}if(Xe&&Xe!==_&&He){var i=_,t=Xe;ze&&(j.current[ze]=0),Oe(null),Be(null),ke(!1),Ie(null),_e(0),Ce(0),ae(i),$([i]),A.current=function(){var e;null!==i&&(null===(e=F)||void 0===e||e.scrollTo(0,j.current[i]));Ke&&Ke({isBack:!0,from:t,to:i})}}var l;(!Ae&&Pe&&Je(Fe(Ve),Qe,J===c.IOS?600:300),Ae!==T.fail||Pe||null===ne)||(null===(l=F)||void 0===l||l.scrollTo(0,j.current[ne]));Xe!==_&&Me&&(Te(!1),ve(null),se(null),G(!1),$([_]),ae(_))}),[_,ne,Ye,Me,I,Re,R,Ze,N,Le,J,Xe,je,Ke,ze,Ae,He,F,Ve,Pe,fe,Qe,Je]),a.createElement(k,m(w({Component:"section"},X),{className:p("vkuiView",J===c.IOS&&p("vkuiView--ios","vkuiInternalView--ios"),!Re&&q&&"vkuiView--animated",!Re&&fe&&"vkuiView--swiping-back",Re&&"vkuiView--no-motion",W),onMoveX:function(e){var n,a,i,t,l;if(!(J!==c.IOS||pe||(a=e,l=a.originalEvent.target,Boolean(null===(t=l)||void 0===t||null===(i=t.closest)||void 0===i?void 0:i.call(t,"input, textarea, [data-vkui-swipe-back=false]")))||Re))if(null===(n=Z)||void 0===n?void 0:n.isWebView){if(O&&!(q&&e.startX<=70)){if(!fe&&e.startX<=70&&S&&S.length>1){var r;if(N)if("prevent"===N(ne))return void we(!0);if(null!==ne)f(R),j.current[ne]=null===(r=F)||void 0===r?void 0:r.getScroll().y;ke(!0),_e(e.startX),Oe(ne),Be(S.slice(-2)[0])}if(fe){var o=0;o=e.shiftX<0?0:e.shiftX>L.innerWidth-be?L.innerWidth:e.shiftX,Ce(o)}}}else(e.startX<=70||e.startX>=L.innerWidth-70)&&!Me&&Te(!0)},onEnd:Ue}),a.createElement("div",{className:"vkuiView__panels"},Le.map((function(e){var n,i=B(e.props),t=q&&i===(te?oe:ce),l=i===oe||i===ye||i===Ve||i===ce&&te;return a.createElement("div",{className:p("vkuiView__panel",i===ne&&"vkuiView__panel--active",i===oe&&"vkuiView__panel--prev",i===ce&&"vkuiView__panel--next",i===ye&&"vkuiView__panel--swipe-back-prev",i===Ve&&"vkuiView__panel--swipe-back-next",Pe===T.success&&"vkuiView__panel--swipe-back-success",Pe===T.fail&&"vkuiView__panel--swipe-back-failed"),onAnimationEnd:t?De:void 0,ref:function(e){return void 0!==i&&(z.current[i]=e)},style:$e(i),key:i},a.createElement("div",{className:"vkuiView__panel-in",style:{marginTop:l?-(null!==(n=j.current[i])&&void 0!==n?n:0):void 0}},a.createElement(M,{entering:i===ce||i===Ve},e)))}))))},A=function(e){var n=e.label,t=e["aria-label"],l=void 0===t?"Назад":t,r=e.className,o=i(e,["label","aria-label","className"]),u=s(),v=b().sizeX,d=void 0===v?"none":v,f=u===c.VKCOM||u===c.IOS,k=a.createElement(N,null);switch(u){case c.IOS:k=a.createElement(P,null);break;case c.VKCOM:k=a.createElement(I,null)}return a.createElement(O,m(w({},o),{className:p(d===_.COMPACT&&"vkuiPanelHeaderBack--sizeX-compact",u===c.IOS&&"vkuiPanelHeaderBack--ios",u===c.VKCOM&&"vkuiPanelHeaderBack--vkcom",f&&!!n&&"vkuiPanelHeaderBack--has-label",r),label:f&&n,"aria-label":l}),k)};const z=({title:e})=>{const n=S();return g.jsx(y,{before:g.jsx(A,{onClick:()=>n.back()}),children:e})};export{z as P,j as V};
