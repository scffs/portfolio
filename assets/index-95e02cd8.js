import{_ as t,j as e}from"./index-928f330e.js";import{_ as n,h as o,j as i,i as a,v as r,a0 as l,l as s,k as d,e as u,a1 as c,a2 as v,a3 as p,a4 as h,c as f,f as m,m as g,a5 as M,K as E,a6 as y,a7 as k,a8 as S,P as x,a9 as C,aa as R,ab as w,O as T,d as O,W as A,ac as P,C as Y,ad as F,G as b,$ as _,ae as D}from"./AppWrapper-679c0da7.js";import{r as H}from"./react-37698f52.js";import{M as j,b as I,a as L}from"./App-a302478c.js";import{g as G}from"./getNavId-aa412334.js";import{t as N,u as q,a as B}from"./useWaitTransitionFinish-63677e62.js";function K(t){return"function"==typeof t}var z=c.join(),V=function(t){var e=t.Component,c=void 0===e?"div":e,h=t.onClose,f=t.restoreFocus,m=void 0===f||f,g=t.timeout,M=void 0===g?0:g,E=t.getRootRef,y=t.children,k=n(t,["Component","onClose","restoreFocus","timeout","getRootRef","children"]),S=o(E),x=i(),C=x.document,R=x.window,w=a(H.useState(null),2),T=w[0],O=w[1],A=a(H.useState(null),2),P=A[0],Y=A[1],F=H.useContext(r).keyboardInput,b=l((function(){var t,e;F&&!(null===(t=S.current)||void 0===t?void 0:t.contains(C.activeElement))&&(null===(e=T)||void 0===e?void 0:e.length)&&T[0].focus()}),M);s((function(){b.set()}),[]),s((function(){if(S.current){var t=[];Array.prototype.forEach.call(S.current.querySelectorAll(z),(function(e){var n=R.getComputedStyle(e),o=n.display,i=n.visibility;"none"!==o&&"hidden"!==i&&t.push(e)})),0===t.length&&t.push(S.current),O(t)}}),[y]);var _=l((function(){P&&P.focus()}),M);s((function(){if(m&&C.activeElement)return Y(C.activeElement),function(){_.set()}}),[m]);return d(C,"keydown",(function(t){var e;if(v(t)===p.TAB&&(null===(e=T)||void 0===e?void 0:e.length)){var n=T.length-1,o=T.findIndex((function(e){return e===t.target})),i=-1===o||o===n&&!t.shiftKey;if(i||0===o&&t.shiftKey){t.preventDefault();var a=T[i?0:n];return a!==C.activeElement&&a.focus(),!1}}return h&&v(t)===p.ESCAPE&&h(),!0}),{capture:!0}),H.createElement(c,u({tabIndex:-1,ref:S},k),y)};function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o,i,a=$(t);if(e){var r=$(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return o=this,!(i=n)||"object"!==h(i)&&"function"!=typeof i?W(o):i}}var Q,X;function Z(t,e){if("setActive"===e.type&&e.id!==t.activeModal){var n=e.id,o=t.exitingModal||t.activeModal,i=t.history?M(t.history):[],a=Boolean(n&&i.includes(n));return null===n?i=[]:a?i=i.splice(0,i.indexOf(n)+1):i.push(n),{activeModal:n,enteringModal:null,exitingModal:o,history:i,isBack:a}}return"entered"===e.type&&e.id===t.enteringModal?f(u({},t),{enteringModal:null}):"exited"===e.type&&e.id===t.exitingModal?f(u({},t),{exitingModal:null}):"inited"===e.type&&e.id===t.activeModal?f(u({},t),{enteringModal:e.id}):t}function tt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:E,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:E,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:E,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:E,d=H.useRef({}).current;(function(t){return H.Children.toArray(t)})(e).forEach((function(t){var e=t.props,n=G(e),o=void 0!==n&&d[n]||{id:null!=n?n:null};o.onOpen=t.props.onOpen,o.onOpened=t.props.onOpened,o.onClose=t.props.onClose,o.onClosed=t.props.onClosed,"number"==typeof e.settlingHeight&&(o.settlingHeight=e.settlingHeight),null!==o.id&&(d[o.id]=o)}));var c=t&&!d[t]?null:t,v=a(H.useReducer(Z,{activeModal:c,enteringModal:null,exitingModal:null,history:c?[c]:[],isBack:!1}),2),p=v[0],h=v[1];s((function(){h({type:"setActive",id:null!=c?c:null})}),[t]),s((function(){p.activeModal&&(l(d[p.activeModal]),h({type:"inited",id:p.activeModal}))}),[p.activeModal]);var m=function(t){var e;return null!=t&&(null===(e=d[t])||void 0===e?void 0:e.type)===Q.CARD},g=H.useCallback((function(t){if(t){var e=d[t];K(e.onOpened)?e.onOpened():K(o)&&o(t)}h({type:"entered",id:t})}),[d,o]),M=H.useCallback((function(t){if(t){var e=d[t];K(e.onClosed)?e.onClosed():K(r)&&r(t)}h({type:"exited",id:t})}),[d,r]),y=Boolean(p.exitingModal&&(m(t)||m(p.exitingModal))),k=H.useCallback((function(t){return t?d[t]:void 0}),[d]);return f(u({onEnter:function(){var t=p.activeModal&&d[p.activeModal];t&&(K(t.onOpen)?t.onOpen():K(n)&&t.id&&n(t.id))},onEntered:g,onExit:function(){var t=p.activeModal&&d[p.activeModal];t&&(K(t.onClose)?t.onClose():K(i)&&t.id&&i(t.id))},onExited:M},p),{delayEnter:y,getModalState:k})}(X=Q||(Q={})).PAGE="page",X.CARD="card";var et,nt,ot=(et="ModalRoot",nt=new Set,function(t){nt.has(t)||(nt.add(t),"%c[VKUI/".concat(et,"] ").concat(t))});function it(t,e){return!!e&&(t>=e[0]&&t<=e[1])}function at(t){return R(t,0,98)}var rt,lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(o,H.Component);var e=J(o);function o(t){var i,a;return P(this,o),i=e.call(this,t),m(W(i),"documentScrolling",!1),m(W(i),"maskElementRef",void 0),m(W(i),"viewportRef",H.createRef()),m(W(i),"maskAnimationFrame",void 0),m(W(i),"modalRootContext",void 0),m(W(i),"frameIds",void 0),m(W(i),"restoreFocusTo",void 0),m(W(i),"preventTouch",(function(t){if(!t)return!1;for(;t.originalEvent;)t=t.originalEvent;return t.preventDefault&&t.preventDefault(),!1})),m(W(i),"updateModalHeight",(function(){var t=i.props.getModalState(i.props.activeModal);t&&t.type===Q.PAGE&&(i.props.enteringModal?i.waitTransitionFinish(t,(function(){requestAnimationFrame((function(){return i.checkPageContentHeight()}))})):requestAnimationFrame((function(){return i.checkPageContentHeight()})))})),m(W(i),"onTouchMove",(function(t){if(!i.props.exitingModal){var e=i.props.getModalState(i.props.activeModal);if(e)return e.type===Q.PAGE?i.onPageTouchMove(t,e):e.type===Q.CARD?i.onCardTouchMove(t,e):void 0}})),m(W(i),"onTouchEnd",(function(t){var e,n,o=i.props.getModalState(i.props.activeModal);return(null===(e=o)||void 0===e?void 0:e.type)===Q.PAGE?i.onPageTouchEnd(t,o):(null===(n=o)||void 0===n?void 0:n.type)===Q.CARD?i.onCardTouchEnd(t,o):void 0})),m(W(i),"onScroll",(function(t){var e,n,o,a=i.props.activeModal,r=t.target;if(a){var l=i.props.getModalState(a);(null===(e=l)||void 0===e?void 0:e.type)===Q.PAGE&&(null===(o=l)||void 0===o||null===(n=o.contentElement)||void 0===n?void 0:n.contains(r))&&(l.contentScrolled=!0,l.contentScrollStopTimeout&&clearTimeout(l.contentScrollStopTimeout),l.contentScrollStopTimeout=setTimeout((function(){l.contentScrolled&&(l.contentScrolled=!1)}),250))}})),i.state={touchDown:!1,dragging:!1,modalOpenedLog:[]},i.maskElementRef=H.createRef(),i.modalRootContext={updateModalHeight:i.updateModalHeight,registerModal:function(t){var e=t.id,o=n(t,["id"]);return Object.assign(null!==(a=i.props.getModalState(e))&&void 0!==a?a:{},o)},onClose:function(){return i.props.onExit()},isInsideModal:!0},i.frameIds={},i}return S(o,[{key:"timeout",get:function(){return this.props.platform===x.IOS?400:320}},{key:"document",get:function(){return this.props.document}},{key:"window",get:function(){return this.props.window}},{key:"getModals",value:function(){return H.Children.toArray(this.props.children)}},{key:"componentDidMount",value:function(){var t;null===(t=this.window)||void 0===t||t.addEventListener("resize",this.updateModalHeight,!1)}},{key:"componentWillUnmount",value:function(){this.toggleDocumentScrolling(!0),this.window.removeEventListener("resize",this.updateModalHeight,!1)}},{key:"componentDidUpdate",value:function(t){var e=this;if(this.props.exitingModal&&this.props.exitingModal!==t.exitingModal&&this.closeModal(this.props.exitingModal),this.props.enteringModal&&this.props.enteringModal!==t.enteringModal){var n,o=this.props.enteringModal,i=this.props.getModalState(o);this.props.onEnter(),this.waitTransitionFinish(i,(function(){var t;(null===(t=i)||void 0===t?void 0:t.innerElement)&&(i.innerElement.style.transitionDelay=""),e.props.onEntered(o)})),(null===(n=i)||void 0===n?void 0:n.innerElement)&&(i.innerElement.style.transitionDelay=this.props.delayEnter?"".concat(this.timeout,"ms"):"",this.animateTranslate(i,i.translateY))}this.props.activeModal&&!t.activeModal&&(this.restoreFocusTo=this.document.activeElement),this.props.activeModal||this.props.exitingModal||!this.restoreFocusTo||(this.restoreFocusTo.focus(),this.restoreFocusTo=null),this.toggleDocumentScrolling(!this.props.activeModal&&!this.props.exitingModal)}},{key:"toggleDocumentScrolling",value:function(t){this.documentScrolling!==t&&(this.documentScrolling=t,t?this.window.removeEventListener("touchmove",this.preventTouch,{passive:!1}):this.window.addEventListener("touchmove",this.preventTouch,{passive:!1}))}},{key:"checkPageContentHeight",value:function(){var t,e,n=this.props.getModalState(this.props.activeModal);if((null===(t=n)||void 0===t?void 0:t.type)===Q.PAGE&&(null===(e=n)||void 0===e?void 0:e.modalElement)){var o=u({},n);dt(n);var i=u({},n),a=!1;o.expandable===i.expandable?o.translateYFrom!==i.translateYFrom&&(a=!0):a=!0,a&&this.animateTranslate(n,n.translateY)}}},{key:"closeModal",value:function(t){var e,n,o=this;this.setState({touchDown:!1});var i=this.props.getModalState(t);if(i){this.state.modalOpenedLog.length||this.setState((function(e){return{modalOpenedLog:M(e.modalOpenedLog).concat([t])}}));var a,r,l,s=this.props.getModalState(this.props.activeModal),d=!!s&&s.type===Q.PAGE,u=!!i&&i.type===Q.PAGE;this.waitTransitionFinish(i,(function(){return o.props.onExited(t)}));var c=u&&d&&(null!==(a=i.translateY)&&void 0!==a?a:0)<=(null!==(r=null===(e=s)||void 0===e?void 0:e.translateYFrom)&&void 0!==r?r:0)&&!this.props.isBack?(null!==(l=null===(n=s)||void 0===n?void 0:n.translateYFrom)&&void 0!==l?l:0)+10:100;this.animateTranslate(i,c),s?s.id&&!this.state.modalOpenedLog.includes(s.id)&&(s.translateY=void 0,this.setState((function(t){return{modalOpenedLog:M(t.modalOpenedLog).concat([s.id])}}))):(this.setMaskOpacity(i,0),this.setState({modalOpenedLog:[]}),i.translateY=void 0)}else t&&ot("closeActiveModal: модальное окно (страница) ".concat(t," не существует"),"error")}},{key:"onPageTouchMove",value:function(t,e){var n,o,i=t.shiftY,a=t.originalEvent,r=a.target;if(t.isY){if(!(null===(n=e.innerElement)||void 0===n?void 0:n.contains(r)))return a.preventDefault();a.stopPropagation();var l,s,d=e.expandable,u=e.contentScrolled,c=e.collapsed,v=e.expanded;if(!this.state.touchDown)e.touchStartContentScrollTop=null!==(s=null===(l=e.contentElement)||void 0===l?void 0:l.scrollTop)&&void 0!==s?s:0,this.setState({touchDown:!0});if(!u&&(null===e.touchMovePositive&&(e.touchMovePositive=i>0),!e.expandable||c||v&&e.touchMovePositive&&0===e.touchStartContentScrollTop||(null===(o=e.headerElement)||void 0===o?void 0:o.contains(r)))){if(a.preventDefault(),!d&&i<0||!this.window)return;!this.state.dragging&&this.setState({dragging:!0});var p,h=i/this.window.innerHeight*100,f=C(h,72,.8,this.props.platform!==x.IOS);e.touchShiftYPercent=h,e.translateYCurrent=at((null!==(p=e.translateY)&&void 0!==p?p:0)+f),this.animateTranslate(e,e.translateYCurrent),this.setMaskOpacity(e)}}else{var m;(null===(m=this.viewportRef.current)||void 0===m?void 0:m.contains(r))&&a.preventDefault()}}},{key:"onCardTouchMove",value:function(t,e){var n,o=t.originalEvent,i=t.shiftY,a=o.target;if(null===(n=e.innerElement)||void 0===n?void 0:n.contains(a)){this.state.touchDown||this.setState({touchDown:!0,dragging:!0});var r,l=i/e.innerElement.offsetHeight*100,s=C(l,72,1.2,this.props.platform!==x.IOS);e.touchShiftYPercent=l,e.translateYCurrent=Math.max(0,(null!==(r=e.translateY)&&void 0!==r?r:0)+s),this.animateTranslate(e,e.translateYCurrent),this.setMaskOpacity(e)}}},{key:"onPageTouchEnd",value:function(t,e){var n,o=this,i=t.startY,a=t.shiftY;if(e.contentScrolled=!1,e.touchMovePositive=null,this.state.dragging&&this.window){var r,l,s,d,u=(i+a)/this.window.innerHeight*100,c=null!==(r=e.translateYCurrent)&&void 0!==r?r:0;if(c=at(c+c/t.duration*240*.6*((null!==(l=e.touchShiftYPercent)&&void 0!==l?l:0)<0?-1:1)),100!==e.settlingHeight)if(it(c,e.expandedRange))c=null!==(d=null===(s=e.expandedRange)||void 0===s?void 0:s[0])&&void 0!==d?d:0;else if(it(c,e.collapsedRange)){var v;c=null!==(v=e.translateYFrom)&&void 0!==v?v:0}else if(it(c,e.hiddenRange))c=100;else{var p;c=null!==(p=e.translateYFrom)&&void 0!==p?p:0}else c=it(c,[0,25])?0:100;100!==c&&u>=75&&(c=100),e.translateY=c,e.translateYCurrent=c,e.collapsed=c>0&&c<u,e.expanded=0===c,e.hidden=100===c,e.hidden&&this.props.onExit(),n=function(){e.hidden||o.animateTranslate(e,e.translateY),o.setMaskOpacity(e)}}this.setState({touchDown:!1,dragging:!1},n)}},{key:"onCardTouchEnd",value:function(t,e){var n,o=t.duration,i=this;if(this.state.dragging){var a,r,l=null!==(a=e.translateYCurrent)&&void 0!==a?a:0,s=l/o*240*.6*((null!==(r=e.touchShiftYPercent)&&void 0!==r?r:0)<0?-1:1);l=(l=Math.max(0,l+s))>=30?100:0,e.translateY=l,e.hidden=100===l,e.hidden&&this.props.onExit(),n=function(){e.hidden||i.animateTranslate(e,e.translateY),i.setMaskOpacity(e)}}this.setState({touchDown:!1,dragging:!1},n)}},{key:"waitTransitionFinish",value:function(t,e){if(N.supported){var n,o,i=function(){var n,o;null===(o=t)||void 0===o||null===(n=o.innerElement)||void 0===n||n.removeEventListener(N.name,i),e()};null===(o=t)||void 0===o||null===(n=o.innerElement)||void 0===n||n.addEventListener(N.name,i)}else setTimeout(e,this.timeout)}},{key:"animateTranslate",value:function(t,e){var n="animateTranslateFrame".concat(t.id);cancelAnimationFrame(this.frameIds[n]),this.frameIds[n]=requestAnimationFrame((function(){var n,o;n=t.innerElement,o="translate3d(0, ".concat(e,"%, 0)"),n&&(n.style.transform=o,n.style.webkitTransform=o)}))}},{key:"setMaskOpacity",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this;null===n&&(null===(e=this.props.history)||void 0===e?void 0:e[0])!==t.id||(this.maskAnimationFrame&&cancelAnimationFrame(this.maskAnimationFrame),this.maskAnimationFrame=requestAnimationFrame((function(){if(o.maskElementRef.current){var e=t.translateY,i=void 0===e?0:e,a=t.translateYCurrent,r=null===n?1-((void 0===a?0:a)-i)/(100-i)||0:n;o.maskElementRef.current.style.opacity=R(r,0,100).toString()}})))}},{key:"render",value:function(){var t,e=this,n=this.props,o=n.activeModal,i=n.exitingModal,a=n.enteringModal,r=this.state,l=r.touchDown,s=r.dragging;return o||i?H.createElement(w.Provider,{value:!0},H.createElement(j.Provider,{value:this.modalRootContext},H.createElement(T,{className:O("vkuiModalRoot",(null===(t=this.props.configProvider)||void 0===t?void 0:t.webviewType)===A.VKAPPS&&"vkuiModalRoot--vkapps",l&&O("vkuiModalRoot--touched","vkuiInternalModalRoot--touched"),!(!a&&!i)&&O("vkuiModalRoot--switching","vkuiInternalModalRoot--switching")),onMove:this.onTouchMove,onEnd:this.onTouchEnd,onScroll:this.onScroll},H.createElement("div",{className:"vkuiModalRoot__mask",onClick:this.props.onExit,ref:this.maskElementRef}),H.createElement("div",{className:"vkuiModalRoot__viewport",ref:this.viewportRef},this.getModals().map((function(t){var n=G(t.props),a=e.props.getModalState(n);if(n!==o&&n!==i||!a)return null;var r=u({},a),l=r.type===Q.PAGE,d="modal-".concat(n);return H.createElement(V,{key:d,getRootRef:function(t){var o=e.props.getModalState(n);o&&(o.modalElement=t)},onClose:e.props.onExit,timeout:e.timeout,className:O("vkuiModalRoot__modal",s&&"vkuiInternalModalRoot__modal--dragging",l&&r.expandable&&"vkuiInternalModalRoot__modal--expandable",l&&r.collapsed&&"vkuiInternalModalRoot__modal--collapsed"),restoreFocus:!1},t)})))))):null}}]),o}(),st=function(t,e,n){return function(o){var i=H.useContext(e);return H.createElement(t,f(u({},o),m({},n,i)))}}((rt=k(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;return function(e){return function(n){var o=tt(n.activeModal,n.children,n.onOpen,n.onOpened,n.onClose,n.onClosed,t);return H.createElement(e,u({},n,o))}}}((function(t){switch(t.type){case Q.PAGE:return t.settlingHeight=t.settlingHeight||75,dt(t);case Q.CARD:return function(t){t.translateY=0}(t)}}))(lt)),function(t){var e=g().platform;return H.createElement(rt,f(u({},t),{platform:e}))}),y,"configProvider");function dt(t){var e,n,o,i=t.contentElement,a=(null===(e=i)||void 0===e?void 0:e.firstElementChild).offsetHeight,r=t.translateY;t.expandable=a>(null!==(o=null===(n=i)||void 0===n?void 0:n.clientHeight)&&void 0!==o?o:0)||100===t.settlingHeight||t.expanded;var l,s,d,u,c,v=!1,p=!1;if(t.expandable){var h,f=(l=100-(null!==(h=t.settlingHeight)&&void 0!==h?h:0))/2,m=100-l;d=[0,f],u=[f,l+m/4],c=[l+m/4,100],v=l>0,p=l<=0,s=l}else{var g,M,E,y,k;d=[s=l=100-(a+(null!==(y=null===(g=t.headerElement)||void 0===g?void 0:g.offsetHeight)&&void 0!==y?y:0))/(null!==(k=null===(E=t.innerElement)||void 0===E||null===(M=E.parentElement)||void 0===M?void 0:M.offsetHeight)&&void 0!==k?k:0)*100,s+25],u=[s+25,s+25],c=[s+25,s+100]}(t.expandable&&s>(null!=r?r:100)||100===t.settlingHeight)&&(s=0),0===s&&(p=!0,v=!1),t.expandedRange=d,t.collapsedRange=u,t.hiddenRange=c,t.translateY=s,t.translateYFrom=l,t.collapsed=v,t.expanded=p}var ut=function(t){var e,o=t.activeModal,a=t.children,r=t.onOpen,l=t.onOpened,s=t.onClose,d=t.onClosed,u=H.useRef(null),c=H.useRef(void 0),v=H.useRef(void 0),p=i().document,h=g(),f=h.webviewType,m=h.platform,M=tt(o,a,r,l,s,d,E),y=M.activeModal,k=M.exitingModal,S=M.onExit,C=M.getModalState,w=M.enteringModal,T=M.onEnter,P=M.onEntered,F=M.onExited,b=M.history,_=M.delayEnter,D=q().waitTransitionFinish,I=B({exitingModal:k,enteringModal:w,activeModal:y}),L=Y({updateModalHeight:function(){},registerModal:function(t){var o=t.id,i=n(t,["id"]);return Object.assign(null!==(e=C(o))&&void 0!==e?e:{},i)},onClose:S,isInsideModal:!0}),N=m===x.IOS?400:320,K=H.Children.toArray(a),z=function(t,e){var n;(null===(n=t)||void 0===n?void 0:n.innerElement)&&(t.innerElement.style.transition="",t.innerElement.style.transitionDelay=e&&_?"".concat(N,"ms"):"",t.innerElement.style.opacity=e?"1":"0")},W=function(t){var e=C(t);e&&(y?F(t):requestAnimationFrame((function(){var n;D(null===(n=e)||void 0===n?void 0:n.innerElement,(function(){return F(t)}),N),z(e,!1),function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===n&&(null===(e=b)||void 0===e?void 0:e[0])!==t.id||(c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){if(u.current){var e=t.translateY,o=void 0===e?0:e,i=t.translateYCurrent,a=null===n?1-((void 0===i?0:i)-o)/(100-o)||0:n;u.current.style.opacity=R(a,0,100).toString()}})))}(e,0)})))};return H.useEffect((function(){if(I){var t,e;if(k&&k!==I.exitingModal&&W(k),w&&w!==I.enteringModal&&function(){var t;if(w&&I){var e=C(w);T(),I.exitingModal?((null===(t=e)||void 0===t?void 0:t.innerElement)&&(e.innerElement.style.transition="none",e.innerElement.style.opacity="1"),P(w)):requestAnimationFrame((function(){var t;w==w&&(D(null===(t=e)||void 0===t?void 0:t.innerElement,(function(){return P(w)}),N),z(e,!0))}))}}(),y&&!I.activeModal)v.current=null!==(e=null===(t=p)||void 0===t?void 0:t.activeElement)&&void 0!==e?e:void 0;y||k||!v.current||(v.current.focus(),v.current=void 0)}})),y||k?H.createElement(j.Provider,{value:L},H.createElement("div",{className:O("vkuiModalRoot",f===A.VKAPPS&&"vkuiModalRoot--vkapps","vkuiModalRoot--desktop")},H.createElement("div",{className:"vkuiModalRoot__mask",ref:u,onClick:S}),H.createElement("div",{className:"vkuiModalRoot__viewport"},K.map((function(t){var e=G(t.props);if(e!==y&&e!==k)return null;var n="modal-".concat(e);return H.createElement(V,{restoreFocus:!1,onClose:S,timeout:N,key:n,className:"vkuiModalRoot__modal"},t)}))))):null},ct=function(t){var e=I().isDesktop;F(!!t.activeModal);var n=e?ut:st;return H.createElement(n,t)};const vt=H.lazy((()=>t((()=>import("./FullstackModal-7243a249.js")),["assets/FullstackModal-7243a249.js","assets/index-928f330e.js","assets/react-37698f52.js","assets/index-152d0029.css","assets/AppWrapper-679c0da7.js","assets/App-a302478c.js","assets/getNavId-aa412334.js","assets/PanelHeaderButton-ad2d11fb.js","assets/Subhead-05121ab4.js","assets/useWaitTransitionFinish-63677e62.js"]))),pt=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const t=b(),{modal:n}=L();return e.jsx(_,{id:"test",children:e.jsx(ct,{activeModal:n,onClose:()=>t.hideModal(),children:e.jsx(vt,{id:D})})})}},Symbol.toStringTag,{value:"Module"}));export{Q as M,pt as i};
