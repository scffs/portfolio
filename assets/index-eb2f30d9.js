var e=Object.defineProperty,n=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(n,a,i)=>a in n?e(n,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[a]=i,l=(e,n)=>{for(var a in n||(n={}))r.call(n,a)&&o(e,a,n[a]);if(i)for(var a of i(n))t.call(n,a)&&o(e,a,n[a]);return e},s=(e,i)=>n(e,a(i)),c=(e,n)=>{var a={};for(var o in e)r.call(e,o)&&n.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&i)for(var o of i(e))n.indexOf(o)<0&&t.call(e,o)&&(a[o]=e[o]);return a};import{y as u,G as p,q as d,h as _,_ as v,p as w,O as f,T as m,o as h}from"./index-3f878bd3.js";import{M as b,f as k,aa as V,i as g,d as y,P as S,h as O,o as T,a7 as x,l as B,a0 as C,c as P,O as E,u as N,S as I,z as j}from"./AppWrapper-86474aa5.js";import{g as M,a as L,u as W,b as X}from"./useWaitTransitionFinish-4778e412.js";import{N as H}from"./Group-543871f8.js";import{a as A}from"./AppearanceProvider-eccdb55f.js";import{i as z,P as D}from"./App-e67a6a65.js";import{s as $,P as F}from"./PanelHeaderButton-b164a809.js";function K(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}var R=b("Icon28ArrowLeftOutline","arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_left_outline_28"><g fill="none" fill-rule="evenodd"><path d="M28 0H0v28h28z" /><path fill="currentColor" fill-rule="nonzero" d="M12.293 6.293a1 1 0 0 1 1.414 1.414L8.414 13H22a1 1 0 0 1 .993.883L23 14a1 1 0 0 1-1 1H8.414l5.293 5.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.414 0l-7-7-.073-.082A1.005 1.005 0 0 1 5 14l.004.09A1.006 1.006 0 0 1 5 14.02V14a1.02 1.02 0 0 1 .125-.484.878.878 0 0 1 .071-.111.999.999 0 0 1 .097-.112l-.08.09c.025-.031.051-.062.08-.09Z" /></g></symbol>',28,28,!1,void 0),Y=b("Icon28ChevronBack","chevron_back_28","0 0 20 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 28" id="chevron_back_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v28H0z" /><path fill="currentColor" d="M4.56 12.94 13 4.5a1.414 1.414 0 0 1 2 2L7.5 14l7.5 7.5a1.414 1.414 0 0 1-2 2l-8.44-8.44a1.5 1.5 0 0 1 0-2.12Z" /></g></symbol>',20,28,!1,void 0),Z=b("Icon28ChevronLeftOutline","chevron_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="chevron_left_outline_28"><path fill="currentColor" d="m12.414 14 5.793-5.793a1 1 0 0 0-1.414-1.414l-6.5 6.5a1 1 0 0 0 0 1.414l6.5 6.5a1 1 0 0 0 1.414-1.414z" /></symbol>',28,28,!1,void 0);const G=p({entering:!1}),q=({children:e,entering:n})=>{const a=d(G),i=A({entering:a.entering||n});return u(G.Provider,{value:i},e)},J=p(void 0),Q=({children:e,isBack:n})=>{const a=d(J),i=void 0!==n?n:a,[r]=_(i);return u(J.Provider,{value:r},e)};function U(e){return ae(e)?(e.nodeName||"").toLowerCase():"#document"}function ee(e){var n;return(null==e||null==(n=e.ownerDocument)?void 0:n.defaultView)||window}function ne(e){var n;return null==(n=(ae(e)?e.ownerDocument:e.document)||window.document)?void 0:n.documentElement}function ae(e){return K(e,Node)||K(e,ee(e).Node)}function ie(e){return K(e,Element)||K(e,ee(e).Element)}function re(e){return K(e,HTMLElement)||K(e,ee(e).HTMLElement)}function te(e){return"undefined"!=typeof ShadowRoot&&(K(e,ShadowRoot)||K(e,ee(e).ShadowRoot))}function oe(e){var n=de(e),a=n.overflow,i=n.overflowX,r=n.overflowY,t=n.display;return/auto|scroll|overlay|hidden|clip/.test(a+r+i)&&!["inline","contents"].includes(t)}function le(e){return["table","td","th"].includes(U(e))}function se(e){var n=ue(),a=de(e);return"none"!==a.transform||"none"!==a.perspective||!!a.containerType&&"normal"!==a.containerType||!n&&!!a.backdropFilter&&"none"!==a.backdropFilter||!n&&!!a.filter&&"none"!==a.filter||["transform","perspective","filter"].some((function(e){return(a.willChange||"").includes(e)}))||["paint","layout","strict","content"].some((function(e){return(a.contain||"").includes(e)}))}function ce(e){for(var n=ve(e);re(n)&&!pe(n);){if(se(n))return n;n=ve(n)}return null}function ue(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function pe(e){return["html","body","#document"].includes(U(e))}function de(e){return ee(e).getComputedStyle(e)}function _e(e){return ie(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function ve(e){if("html"===U(e))return e;var n=e.assignedSlot||e.parentNode||te(e)&&e.host||ne(e);return te(n)?n.host:n}function we(e){var n=ve(e);return pe(n)?e.ownerDocument?e.ownerDocument.body:e.body:re(n)&&oe(n)?n:we(n)}function fe(e,n,a){var i;void 0===n&&(n=[]),void 0===a&&(a=!0);var r=we(e),t=r===(null==(i=e.ownerDocument)?void 0:i.body),o=ee(r);return t?n.concat(o,o.visualViewport||[],oe(r)?r:[],o.frameElement&&a?fe(o.frameElement):[]):n.concat(r,fe(r,[],a))}const me=(e,n,a)=>({swipedToOpposite:n<0,swipeBackTriggered:n>=10,viewportStartEdgeTouched:e<=20,viewportEndEdgeTouched:e>=a-20}),he={View:"_View_9hasv_1","View--animated":"_View--animated_9hasv_8","View--swiping-back":"_View--swiping-back_9hasv_9",View__panel:"_View__panel_9hasv_13",View__header:"_View__header_9hasv_14",View__panels:"_View__panels_9hasv_20","View__panel-in":"_View__panel-in_9hasv_33","View__panel-overlay":"_View__panel-overlay_9hasv_45","View--ios":"_View--ios_9hasv_61","View__panel--swipe-back-prev":"_View__panel--swipe-back-prev_9hasv_61","View__panel--swipe-back-success":"_View__panel--swipe-back-success_9hasv_61","View__panel--swipe-back-next":"_View__panel--swipe-back-next_9hasv_66","View__panel--swipe-back-failed":"_View__panel--swipe-back-failed_9hasv_71","View__panel--next":"_View__panel--next_9hasv_94","View__panel--prev":"_View__panel--prev_9hasv_94","animation-view-prev-back":"_animation-view-prev-back_9hasv_1","animation-view-next-forward":"_animation-view-next-forward_9hasv_1","View--no-motion":"_View--no-motion_9hasv_102","animation-ios-prev-forward":"_animation-ios-prev-forward_9hasv_1","animation-ios-next-back":"_animation-ios-next-back_9hasv_1","animation-ios-next-forward":"_animation-ios-next-forward_9hasv_1","animation-ios-prev-back":"_animation-ios-prev-back_9hasv_1","animation-ios-fade-in":"_animation-ios-fade-in_9hasv_1","animation-ios-fade-out":"_animation-ios-fade-out_9hasv_1","View__panel--active":"_View__panel--active_9hasv_173"};var be,ke;(ke=be||(be={}))[ke.fail=1]="fail",ke[ke.success=2]="success";let Ve={};const ge=e=>{var n=e,{activePanel:a,history:i,nav:r,onTransition:t,onSwipeBack:o,onSwipeBackStart:p,onSwipeBackCancel:d,children:h,className:b}=n,N=c(n,["activePanel","history","nav","onTransition","onSwipeBack","onSwipeBackStart","onSwipeBackCancel","children","className"]);const I=M({nav:r,id:N.id}),j=v(Ve[I]||{}),A=v(T);w((()=>()=>{I&&(Ve[I]=j.current)}));const D=v({}),{window:$,document:F}=k(),K=V(),R=g(),Y=z(),Z=y(),[G,J]=_(!1),[U,ee]=_([a]),[ne,ae]=_(a),[ie,re]=_(void 0),[te,oe]=_(null),[le,se]=_(null),ce=v(!1),[ue,pe]=_(void 0),[de,_e]=_(0),[ve,we]=_(0),[be,ke]=_(null),[ge,ye]=_(null),[Se,Oe]=_(null),[Te,xe]=_(!1),Be=L(a),Ce=L(ue),Pe=L(Te),Ee=L(Se),Ne=L(ge),Ie=L(t),je=f.toArray(h).filter((e=>{const n=M(e.props);return void 0!==n&&U.includes(n)||n===ge||n===be})),Me=!R.transitionMotionEnabled||!Y.animate||Z===S.VKCOM,Le=!Me&&Z===S.IOS&&R.isWebView&&Boolean(o),We=e=>null===e?null:D.current[e],Xe=m(((e,n)=>{n&&(j.current[e]=0),oe(null),se(null),ee([a]),ae(a),J(!1),re(n),A.current=()=>{null==K||K.scrollTo(0,n?j.current[a]:0),t&&t({isBack:n,from:e,to:a})}}),[a,t,K]);O((()=>{A.current(),A.current=T}),[A.current]);const He=m((e=>{e&&![he["animation-ios-next-forward"],he["animation-ios-prev-back"],he["animation-view-next-forward"],he["animation-view-prev-back"]].includes(e.animationName)||null===te||Xe(te,Boolean(ie))}),[Xe,ie,te]),{waitTransitionFinish:Ae}=W(),ze=x(He,Z===S.IOS?600:300),De=m((()=>{o&&o()}),[o]),$e=m((()=>{d&&d(),ye(null),ke(null),pe(!1),Oe(null),_e(0),we(0)}),[d]),Fe=m((e=>{if(!e||(null==e?void 0:e.propertyName.includes("transform"))&&(null==e?void 0:e.target)===We(be))switch(Se){case 1:$e();break;case 2:De()}}),[$e,De,be,Se]),Ke=e=>{if(!E||!$)return{};const n=e===ge,a=e===be;if(!n&&!a||Se)return{};let i=`${ve}px`,r=100*ve/$.innerWidth/2-50+"%";return a?{transform:`translate3d(${r}, 0, 0)`,WebkitTransform:`translate3d(${r}, 0, 0)`}:n?{transform:`translate3d(${i}, 0, 0)`,WebkitTransform:`translate3d(${i}, 0, 0)`}:{}},Re=e=>{if(!E||!$)return{};if(!(e===be))return{};const n=1-ve/$.innerWidth,a=2===Se?0:1===Se?1:null;return{display:"block",opacity:null===a?n:a}};return w((()=>{if(Be&&Be!==a&&!Ce&&!Pe){const e=f.toArray(h).map((e=>M(e.props))).find((e=>e===Be||e===a))===a;j.current[Be]=null==K?void 0:K.getScroll().y,Me?Xe(Be,e):(B(F),ee([Be,a]),oe(Be),se(a),ae(null),J(!0),re(e),X.supported||ze.set())}if(Be&&Be!==a&&Ce){const e=a,n=Be;Ne&&(j.current[Ne]=0),ye(null),ke(null),pe(!1),Oe(null),_e(0),we(0),ae(e),ee([e]),re(!0),A.current=()=>{null!==e&&(null==K||K.scrollTo(0,j.current[e])),Ie&&Ie({isBack:!0,from:n,to:e})}}!Ee&&Se&&Ae(We(be),Fe,Z===S.IOS?600:300),1!==Ee||Se||null===ne||null==K||K.scrollTo(0,j.current[ne]),Be!==a&&Te&&(xe(!1),se(null),oe(null),J(!1),ee([a]),ae(a))}),[a,ne,ze,Te,h,Me,F,Xe,Z,Be,Pe,Ie,Ne,Ee,Ce,K,be,Se,Fe,Ae]),u(H.Provider,{value:I},u(C,s(l({Component:"section"},N),{className:P(he.View,Z===S.IOS&&P(he["View--ios"],"vkuiInternalView--ios"),!Me&&G&&he["View--animated"],!Me&&ue&&he["View--swiping-back"],Me&&he["View--no-motion"],b),onMoveX:Le?e=>{if(ce.current||function(e){var n;const a=e.originalEvent.target;return Boolean(null==(n=null==a?void 0:a.closest)?void 0:n.call(a,"input, textarea, [data-vkui-swipe-back=false]"))}(e))return;const{swipedToOpposite:n,swipeBackTriggered:a,viewportStartEdgeTouched:r}=me(e.startX,e.shiftX,$.innerWidth);if(!G||!a){if(!ue&&i&&i.length>1){if(n)return void(ce.current=!0);if(!a)return;if(!r&&fe(e.originalEvent.target).some((e=>"scrollLeft"in e&&e.scrollLeft>0)))return void(ce.current=!0);if(p){if("prevent"===p(ne))return void(ce.current=!0)}null!==ne&&(B(F),j.current[ne]=null==K?void 0:K.getScroll().y),pe(!0),_e(e.startX),ye(ne),ke(i.slice(-2)[0])}ue&&(e.shiftX<0?we(0):e.shiftX>$.innerWidth-de?we($.innerWidth):we(e.shiftX))}}:Z===S.IOS?e=>{if(Te)return;const{swipeBackTriggered:n,viewportStartEdgeTouched:a,viewportEndEdgeTouched:i}=me(e.startX,e.shiftX,$.innerWidth);(a||i)&&n&&xe(!0)}:void 0,onEnd:Le?e=>{var n;if(ce.current=!1,ue){const a=ve/e.duration*1e3;0===ve?$e():ve>=(null!=(n=$.innerWidth)?n:0)?De():a>250||ve>=$.innerWidth/2?Oe(2):Oe(1)}}:void 0}),u("div",{className:he.View__panels},je.map((e=>{var n;const a=M(e.props),i=G&&a===(ie?te:le),r=a===te||a===ge||a===be||a===le&&ie;return u("div",{className:P(he.View__panel,a===ne&&he["View__panel--active"],a===te&&he["View__panel--prev"],a===le&&he["View__panel--next"],a===ge&&he["View__panel--swipe-back-prev"],a===be&&he["View__panel--swipe-back-next"],2===Se&&he["View__panel--swipe-back-success"],1===Se&&he["View__panel--swipe-back-failed"]),onAnimationEnd:i?He:void 0,ref:e=>void 0!==a&&(D.current[a]=e),style:Ke(a),key:a},Z===S.IOS&&u("div",{className:he["View__panel-overlay"],style:Re(a)}),u("div",{className:he["View__panel-in"],style:{marginTop:r?-(null!=(n=j.current[a])?n:0):void 0}},u(Q,{isBack:ue||ie},u(q,{entering:a===le||a===be},e))))})))))},ye=e=>{var n=e,{label:a,"aria-label":i="Назад",className:r}=n,t=c(n,["label","aria-label","className"]);const o=y(),{sizeX:p="none"}=N(),d=o===S.VKCOM||o===S.IOS;let _=u(R,null);switch(o){case S.IOS:_=u(Y,null);break;case S.VKCOM:_=u(Z,null)}return u(F,s(l({},t),{className:P(p===I.COMPACT&&$["PanelHeaderBack--sizeX-compact"],o===S.IOS&&$["PanelHeaderBack--ios"],o===S.VKCOM&&$["PanelHeaderBack--vkcom"],d&&!!a&&$["PanelHeaderBack--has-label"],r),label:d&&a,"aria-label":i}),_)},Se=({title:e})=>{const n=j();return h(D,{before:h(ye,{onClick:()=>n.back()}),children:e})};export{Se as P,ge as V,fe as a,re as b,ee as c,de as d,U as e,oe as f,ne as g,_e as h,ie as i,le as j,se as k,ce as l,ue as m,ve as n,pe as o};
