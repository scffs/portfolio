var e=Object.defineProperty,n=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(n,a,t)=>a in n?e(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,l=(e,n)=>{for(var a in n||(n={}))i.call(n,a)&&o(e,a,n[a]);if(t)for(var a of t(n))r.call(n,a)&&o(e,a,n[a]);return e},s=(e,t)=>n(e,a(t)),c=(e,n)=>{var a={};for(var o in e)i.call(e,o)&&n.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&t)for(var o of t(e))n.indexOf(o)<0&&r.call(e,o)&&(a[o]=e[o]);return a};import{r as u}from"./react-37698f52.js";import{N as d,r as p,t as _,f,af as v,i as w,d as m,P as h,h as b,a9 as k,o as V,a4 as S,c as g,X as y,u as E,S as x,F as C}from"./AppWrapper-9701c826.js";import{g as O,a as T,u as B,b as P}from"./useWaitTransitionFinish-e87f379a.js";import{N}from"./Group-914dafc3.js";import{i as j,P as I}from"./App-33f3984a.js";import{j as X}from"./index-a570bfc0.js";import{P as L,s as M}from"./PanelHeaderButton-5dd34c4f.js";var W=d("Icon28ArrowLeftOutline","arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_left_outline_28"><g fill="none" fill-rule="evenodd"><path d="M28 0H0v28h28z" /><path fill="currentColor" fill-rule="nonzero" d="M12.293 6.293a1 1 0 0 1 1.414 1.414L8.414 13H22a1 1 0 0 1 .993.883L23 14a1 1 0 0 1-1 1H8.414l5.293 5.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.414 0l-7-7-.073-.082A1.005 1.005 0 0 1 5 14l.004.09A1.006 1.006 0 0 1 5 14.02V14a1.02 1.02 0 0 1 .125-.484.878.878 0 0 1 .071-.111.999.999 0 0 1 .097-.112l-.08.09c.025-.031.051-.062.08-.09Z" /></g></symbol>',28,28,!1,void 0),H=d("Icon28ChevronBack","chevron_back_28","0 0 20 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 28" id="chevron_back_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v28H0z" /><path fill="currentColor" d="M4.56 12.94 13 4.5a1.414 1.414 0 0 1 2 2L7.5 14l7.5 7.5a1.414 1.414 0 0 1-2 2l-8.44-8.44a1.5 1.5 0 0 1 0-2.12Z" /></g></symbol>',20,28,!1,void 0),A=d("Icon28ChevronLeftOutline","chevron_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="chevron_left_outline_28"><path fill="currentColor" d="m12.414 14 5.793-5.793a1 1 0 0 0-1.414-1.414l-6.5 6.5a1 1 0 0 0 0 1.414l6.5 6.5a1 1 0 0 0 1.414-1.414z" /></symbol>',28,28,!1,void 0);const R=u.createContext({entering:!1}),z=({children:e,entering:n})=>{const a=u.useContext(R),t=p({entering:a.entering||n});return u.createElement(R.Provider,{value:t},e)},D=u.createContext(void 0),F=({children:e,isBack:n})=>{const a=u.useContext(D),t=void 0!==n?n:a,[i]=u.useState(t);return u.createElement(D.Provider,{value:i},e)};function $(e){return Z(e)?(e.nodeName||"").toLowerCase():"#document"}function K(e){var n;return(null==e||null==(n=e.ownerDocument)?void 0:n.defaultView)||window}function Y(e){var n;return null==(n=(Z(e)?e.ownerDocument:e.document)||window.document)?void 0:n.documentElement}function Z(e){return e instanceof Node||e instanceof K(e).Node}function q(e){return e instanceof Element||e instanceof K(e).Element}function G(e){return e instanceof HTMLElement||e instanceof K(e).HTMLElement}function J(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof K(e).ShadowRoot)}function Q(e){const{overflow:n,overflowX:a,overflowY:t,display:i}=ie(e);return/auto|scroll|overlay|hidden|clip/.test(n+t+a)&&!["inline","contents"].includes(i)}function U(e){return["table","td","th"].includes($(e))}function ee(e){const n=ae(),a=ie(e);return"none"!==a.transform||"none"!==a.perspective||!!a.containerType&&"normal"!==a.containerType||!n&&!!a.backdropFilter&&"none"!==a.backdropFilter||!n&&!!a.filter&&"none"!==a.filter||["transform","perspective","filter"].some((e=>(a.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(a.contain||"").includes(e)))}function ne(e){let n=oe(e);for(;G(n)&&!te(n);){if(ee(n))return n;n=oe(n)}return null}function ae(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function te(e){return["html","body","#document"].includes($(e))}function ie(e){return K(e).getComputedStyle(e)}function re(e){return q(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function oe(e){if("html"===$(e))return e;const n=e.assignedSlot||e.parentNode||J(e)&&e.host||Y(e);return J(n)?n.host:n}function le(e){const n=oe(e);return te(n)?e.ownerDocument?e.ownerDocument.body:e.body:G(n)&&Q(n)?n:le(n)}function se(e,n,a){var t;void 0===n&&(n=[]),void 0===a&&(a=!0);const i=le(e),r=i===(null==(t=e.ownerDocument)?void 0:t.body),o=K(i);return r?n.concat(o,o.visualViewport||[],Q(i)?i:[],o.frameElement&&a?se(o.frameElement):[]):n.concat(i,se(i,[],a))}const ce=(e,n,a)=>({swipedToOpposite:n<0,swipeBackTriggered:n>=10,viewportStartEdgeTouched:e<=20,viewportEndEdgeTouched:e>=a-20}),ue={View:"_View_9hasv_1","View--animated":"_View--animated_9hasv_8","View--swiping-back":"_View--swiping-back_9hasv_9",View__panel:"_View__panel_9hasv_13",View__header:"_View__header_9hasv_14",View__panels:"_View__panels_9hasv_20","View__panel-in":"_View__panel-in_9hasv_33","View__panel-overlay":"_View__panel-overlay_9hasv_45","View--ios":"_View--ios_9hasv_61","View__panel--swipe-back-prev":"_View__panel--swipe-back-prev_9hasv_61","View__panel--swipe-back-success":"_View__panel--swipe-back-success_9hasv_61","View__panel--swipe-back-next":"_View__panel--swipe-back-next_9hasv_66","View__panel--swipe-back-failed":"_View__panel--swipe-back-failed_9hasv_71","View__panel--next":"_View__panel--next_9hasv_94","View__panel--prev":"_View__panel--prev_9hasv_94","animation-view-prev-back":"_animation-view-prev-back_9hasv_1","animation-view-next-forward":"_animation-view-next-forward_9hasv_1","View--no-motion":"_View--no-motion_9hasv_102","animation-ios-prev-forward":"_animation-ios-prev-forward_9hasv_1","animation-ios-next-back":"_animation-ios-next-back_9hasv_1","animation-ios-next-forward":"_animation-ios-next-forward_9hasv_1","animation-ios-prev-back":"_animation-ios-prev-back_9hasv_1","animation-ios-fade-in":"_animation-ios-fade-in_9hasv_1","animation-ios-fade-out":"_animation-ios-fade-out_9hasv_1","View__panel--active":"_View__panel--active_9hasv_173"};var de,pe;(pe=de||(de={}))[pe.fail=1]="fail",pe[pe.success=2]="success";let _e={};const fe=e=>{var n=e,{activePanel:a,history:t,nav:i,onTransition:r,onSwipeBack:o,onSwipeBackStart:d,onSwipeBackCancel:p,children:E,className:x}=n,C=c(n,["activePanel","history","nav","onTransition","onSwipeBack","onSwipeBackStart","onSwipeBackCancel","children","className"]);const I=O({nav:i,id:C.id}),X=u.useRef(_e[I]||{}),L=u.useRef(_);u.useEffect((()=>()=>{I&&(_e[I]=X.current)}));const M=u.useRef({}),{window:W,document:H}=f(),A=v(),R=w(),D=j(),$=m(),[K,Y]=u.useState(!1),[Z,q]=u.useState([a]),[G,J]=u.useState(a),[Q,U]=u.useState(void 0),[ee,ne]=u.useState(null),[ae,te]=u.useState(null),ie=u.useRef(!1),[re,oe]=u.useState(void 0),[le,de]=u.useState(0),[pe,fe]=u.useState(0),[ve,we]=u.useState(null),[me,he]=u.useState(null),[be,ke]=u.useState(null),[Ve,Se]=u.useState(!1),ge=T(a),ye=T(re),Ee=T(Ve),xe=T(be),Ce=T(me),Oe=T(r),Te=u.Children.toArray(E).filter((e=>{const n=O(e.props);return void 0!==n&&Z.includes(n)||n===me||n===ve})),Be=!R.transitionMotionEnabled||!D.animate||$===h.VKCOM,Pe=!Be&&$===h.IOS&&R.isWebView&&Boolean(o),Ne=e=>null===e?null:M.current[e],je=u.useCallback(((e,n)=>{n&&(X.current[e]=0),ne(null),te(null),q([a]),J(a),Y(!1),U(n),L.current=()=>{null==A||A.scrollTo(0,n?X.current[a]:0),r&&r({isBack:n,from:e,to:a})}}),[a,r,A]);b((()=>{L.current(),L.current=_}),[L.current]);const Ie=u.useCallback((e=>{e&&![ue["animation-ios-next-forward"],ue["animation-ios-prev-back"],ue["animation-view-next-forward"],ue["animation-view-prev-back"]].includes(e.animationName)||null===ee||je(ee,Boolean(Q))}),[je,Q,ee]),{waitTransitionFinish:Xe}=B(),Le=k(Ie,$===h.IOS?600:300),Me=u.useCallback((()=>{o&&o()}),[o]),We=u.useCallback((()=>{p&&p(),he(null),we(null),oe(!1),ke(null),de(0),fe(0)}),[p]),He=u.useCallback((e=>{if(!e||(null==e?void 0:e.propertyName.includes("transform"))&&(null==e?void 0:e.target)===Ne(ve))switch(be){case 1:We();break;case 2:Me()}}),[We,Me,ve,be]),Ae=e=>{if(!y||!W)return{};const n=e===me,a=e===ve;if(!n&&!a||be)return{};let t=`${pe}px`,i=100*pe/W.innerWidth/2-50+"%";return a?{transform:`translate3d(${i}, 0, 0)`,WebkitTransform:`translate3d(${i}, 0, 0)`}:n?{transform:`translate3d(${t}, 0, 0)`,WebkitTransform:`translate3d(${t}, 0, 0)`}:{}},Re=e=>{if(!y||!W)return{};if(!(e===ve))return{};const n=1-pe/W.innerWidth,a=2===be?0:1===be?1:null;return{display:"block",opacity:null===a?n:a}};return u.useEffect((()=>{if(ge&&ge!==a&&!ye&&!Ee){const e=u.Children.toArray(E).map((e=>O(e.props))).find((e=>e===ge||e===a))===a;X.current[ge]=null==A?void 0:A.getScroll().y,Be?je(ge,e):(V(H),q([ge,a]),ne(ge),te(a),J(null),Y(!0),U(e),P.supported||Le.set())}if(ge&&ge!==a&&ye){const e=a,n=ge;Ce&&(X.current[Ce]=0),he(null),we(null),oe(!1),ke(null),de(0),fe(0),J(e),q([e]),U(!0),L.current=()=>{null!==e&&(null==A||A.scrollTo(0,X.current[e])),Oe&&Oe({isBack:!0,from:n,to:e})}}!xe&&be&&Xe(Ne(ve),He,$===h.IOS?600:300),1!==xe||be||null===G||null==A||A.scrollTo(0,X.current[G]),ge!==a&&Ve&&(Se(!1),te(null),ne(null),Y(!1),q([a]),J(a))}),[a,G,Le,Ve,E,Be,H,je,$,ge,Ee,Oe,Ce,xe,ye,A,ve,be,He,Xe]),u.createElement(N.Provider,{value:I},u.createElement(S,s(l({Component:"section"},C),{className:g(ue.View,$===h.IOS&&g(ue["View--ios"],"vkuiInternalView--ios"),!Be&&K&&ue["View--animated"],!Be&&re&&ue["View--swiping-back"],Be&&ue["View--no-motion"],x),onMoveX:Pe?e=>{if(ie.current||function(e){var n;const a=e.originalEvent.target;return Boolean(null==(n=null==a?void 0:a.closest)?void 0:n.call(a,"input, textarea, [data-vkui-swipe-back=false]"))}(e))return;const{swipedToOpposite:n,swipeBackTriggered:a,viewportStartEdgeTouched:i}=ce(e.startX,e.shiftX,W.innerWidth);if(!K||!a){if(!re&&t&&t.length>1){if(n)return void(ie.current=!0);if(!a)return;if(!i&&se(e.originalEvent.target).some((e=>"scrollLeft"in e&&e.scrollLeft>0)))return void(ie.current=!0);if(d){if("prevent"===d(G))return void(ie.current=!0)}null!==G&&(V(H),X.current[G]=null==A?void 0:A.getScroll().y),oe(!0),de(e.startX),he(G),we(t.slice(-2)[0])}re&&(e.shiftX<0?fe(0):e.shiftX>W.innerWidth-le?fe(W.innerWidth):fe(e.shiftX))}}:$===h.IOS?e=>{if(Ve)return;const{swipeBackTriggered:n,viewportStartEdgeTouched:a,viewportEndEdgeTouched:t}=ce(e.startX,e.shiftX,W.innerWidth);(a||t)&&n&&Se(!0)}:void 0,onEnd:Pe?e=>{var n;if(ie.current=!1,re){const a=pe/e.duration*1e3;0===pe?We():pe>=(null!=(n=W.innerWidth)?n:0)?Me():a>250||pe>=W.innerWidth/2?ke(2):ke(1)}}:void 0}),u.createElement("div",{className:ue.View__panels},Te.map((e=>{var n;const a=O(e.props),t=K&&a===(Q?ee:ae),i=a===ee||a===me||a===ve||a===ae&&Q;return u.createElement("div",{className:g(ue.View__panel,a===G&&ue["View__panel--active"],a===ee&&ue["View__panel--prev"],a===ae&&ue["View__panel--next"],a===me&&ue["View__panel--swipe-back-prev"],a===ve&&ue["View__panel--swipe-back-next"],2===be&&ue["View__panel--swipe-back-success"],1===be&&ue["View__panel--swipe-back-failed"]),onAnimationEnd:t?Ie:void 0,ref:e=>void 0!==a&&(M.current[a]=e),style:Ae(a),key:a},$===h.IOS&&u.createElement("div",{className:ue["View__panel-overlay"],style:Re(a)}),u.createElement("div",{className:ue["View__panel-in"],style:{marginTop:i?-(null!=(n=X.current[a])?n:0):void 0}},u.createElement(F,{isBack:re||Q},u.createElement(z,{entering:a===ae||a===ve},e))))})))))},ve=e=>{var n=e,{label:a,"aria-label":t="Назад",className:i}=n,r=c(n,["label","aria-label","className"]);const o=m(),{sizeX:d="none"}=E(),p=o===h.VKCOM||o===h.IOS;let _=u.createElement(W,null);switch(o){case h.IOS:_=u.createElement(H,null);break;case h.VKCOM:_=u.createElement(A,null)}return u.createElement(L,s(l({},r),{className:g(d===x.COMPACT&&M["PanelHeaderBack--sizeX-compact"],o===h.IOS&&M["PanelHeaderBack--ios"],o===h.VKCOM&&M["PanelHeaderBack--vkcom"],p&&!!a&&M["PanelHeaderBack--has-label"],i),label:p&&a,"aria-label":t}),_)},we=({title:e})=>{const n=C();return X.jsx(I,{before:X.jsx(ve,{onClick:()=>n.back()}),children:e})};export{we as P,fe as V,G as a,$ as b,Q as c,re as d,K as e,U as f,Y as g,ie as h,q as i,ee as j,ne as k,se as l,oe as m,te as n,ae as o};
