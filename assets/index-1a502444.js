var e=Object.defineProperty,a=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(a,n,i)=>n in a?e(a,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[n]=i,o=(e,a)=>{for(var n in a||(a={}))t.call(a,n)&&r(e,n,a[n]);if(i)for(var n of i(a))l.call(a,n)&&r(e,n,a[n]);return e},s=(e,i)=>a(e,n(i)),c=(e,a)=>{var n={};for(var r in e)t.call(e,r)&&a.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&i)for(var r of i(e))a.indexOf(r)<0&&l.call(e,r)&&(n[r]=e[r]);return n};import{r as u}from"./react-37698f52.js";import{N as _,w as p,x as w,f as v,ac as d,i as k,d as f,P as m,h as b,a6 as g,v as V,a1 as h,c as x,k as S,u as C,S as O,F as y}from"./AppWrapper-5480904f.js";import{g as B,a as P,u as E,b as j}from"./useWaitTransitionFinish-8b3842da.js";import{d as W,P as I}from"./App-8bfc4f78.js";import{j as N}from"./index-0557fdb9.js";import{P as M,s as T}from"./PanelHeaderButton-2bb0551e.js";var X=_("Icon28ArrowLeftOutline","arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_left_outline_28"><g fill="none" fill-rule="evenodd"><path d="M28 0H0v28h28z" /><path fill="currentColor" fill-rule="nonzero" d="M12.293 6.293a1 1 0 0 1 1.414 1.414L8.414 13H22a1 1 0 0 1 .993.883L23 14a1 1 0 0 1-1 1H8.414l5.293 5.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.414 0l-7-7-.073-.082A1.005 1.005 0 0 1 5 14l.004.09A1.006 1.006 0 0 1 5 14.02V14a1.02 1.02 0 0 1 .125-.484.878.878 0 0 1 .071-.111.999.999 0 0 1 .097-.112l-.08.09c.025-.031.051-.062.08-.09Z" /></g></symbol>',28,28,!1,void 0),A=_("Icon28ChevronBack","chevron_back_28","0 0 20 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 28" id="chevron_back_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v28H0z" /><path fill="currentColor" d="M4.56 12.94 13 4.5a1.414 1.414 0 0 1 2 2L7.5 14l7.5 7.5a1.414 1.414 0 0 1-2 2l-8.44-8.44a1.5 1.5 0 0 1 0-2.12Z" /></g></symbol>',20,28,!1,void 0),H=_("Icon28ChevronLeftOutline","chevron_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="chevron_left_outline_28"><path fill="currentColor" d="m12.414 14 5.793-5.793a1 1 0 0 0-1.414-1.414l-6.5 6.5a1 1 0 0 0 0 1.414l6.5 6.5a1 1 0 0 0 1.414-1.414z" /></symbol>',28,28,!1,void 0);const $=u.createContext({entering:!1}),z=({children:e,entering:a})=>{const n=u.useContext($),i=p({entering:n.entering||a});return u.createElement($.Provider,{value:i},e)};const L={View:"_View_k1ega_1","View--animated":"_View--animated_k1ega_8","View--swiping-back":"_View--swiping-back_k1ega_9",View__panel:"_View__panel_k1ega_13",View__header:"_View__header_k1ega_14",View__panels:"_View__panels_k1ega_20","View__panel-in":"_View__panel-in_k1ega_33","View__panel--next":"_View__panel--next_k1ega_49","View__panel--prev":"_View__panel--prev_k1ega_49","vkui-animation-view-prev-back":"_vkui-animation-view-prev-back_k1ega_1","vkui-animation-view-next-forward":"_vkui-animation-view-next-forward_k1ega_1","View--no-motion":"_View--no-motion_k1ega_57","View--ios":"_View--ios_k1ega_89","View__panel--swipe-back-prev":"_View__panel--swipe-back-prev_k1ega_89","View__panel--swipe-back-success":"_View__panel--swipe-back-success_k1ega_93","View__panel--swipe-back-next":"_View__panel--swipe-back-next_k1ega_98","View__panel--swipe-back-failed":"_View__panel--swipe-back-failed_k1ega_103","vkui-animation-ios-prev-forward":"_vkui-animation-ios-prev-forward_k1ega_1","vkui-animation-ios-next-back":"_vkui-animation-ios-next-back_k1ega_1","vkui-animation-ios-next-forward":"_vkui-animation-ios-next-forward_k1ega_1","vkui-animation-ios-prev-back":"_vkui-animation-ios-prev-back_k1ega_1","vkui-animation-ios-fade-in":"_vkui-animation-ios-fade-in_k1ega_1","vkui-animation-ios-fade-out":"_vkui-animation-ios-fade-out_k1ega_1","View__panel--active":"_View__panel--active_k1ega_167"};var K,F;(F=K||(K={}))[F.fail=1]="fail",F[F.success=2]="success";let R={};const Z=e=>{var a=e,{activePanel:n,history:i,nav:t,onTransition:l,onSwipeBack:r,onSwipeBackStart:_,onSwipeBackCancel:p,children:C,className:O}=a,y=c(a,["activePanel","history","nav","onTransition","onSwipeBack","onSwipeBackStart","onSwipeBackCancel","children","className"]);const I=u.useRef(R[B({nav:t,id:y.id})]||{}),N=u.useRef(w);u.useEffect((()=>()=>{const e=B({nav:t,id:y.id});e&&(R[e]=I.current)}));const M=u.useRef({}),{window:T,document:X}=v(),A=d(),H=k(),$=W(),F=f(),[Z,q]=u.useState(!1),[D,G]=u.useState([n]),[J,Q]=u.useState(n),[U,Y]=u.useState(void 0),[ee,ae]=u.useState(null),[ne,ie]=u.useState(null),[te,le]=u.useState(!1),[re,oe]=u.useState(!1),[se,ce]=u.useState(0),[ue,_e]=u.useState(0),[pe,we]=u.useState(null),[ve,de]=u.useState(null),[ke,fe]=u.useState(null),[me,be]=u.useState(!1),ge=P(n),Ve=P(te),he=P(me),xe=P(ke),Se=P(ve),Ce=P(l),Oe=u.Children.toArray(C).filter((e=>{const a=B(e.props);return void 0!==a&&D.includes(a)||a===ve||a===pe})),ye=!1===(null==H?void 0:H.transitionMotionEnabled)||!(null==$?void 0:$.animate)||F===m.VKCOM,Be=e=>null===e?null:M.current[e],Pe=u.useCallback(((e,a)=>{a&&(I.current[e]=0),ae(null),ie(null),G([n]),Q(n),q(!1),Y(void 0),N.current=()=>{null==A||A.scrollTo(0,a?I.current[n]:0),l&&l({isBack:a,from:e,to:n})}}),[n,l,A]);b((()=>{N.current(),N.current=w}),[N.current]);const Ee=u.useCallback((e=>{e&&![L["vkui-animation-ios-next-forward"],L["vkui-animation-ios-prev-back"],L["vkui-animation-view-next-forward"],L["vkui-animation-view-prev-back"]].includes(e.animationName)||null===ee||Pe(ee,Boolean(U))}),[Pe,U,ee]),{waitTransitionFinish:je}=E(),We=g(Ee,F===m.IOS?600:300),Ie=u.useCallback((()=>{r&&r()}),[r]),Ne=u.useCallback((()=>{p&&p(),de(null),we(null),le(!1),fe(null),ce(0),_e(0)}),[p]),Me=u.useCallback((e=>{if(!e||(null==e?void 0:e.propertyName.includes("transform"))&&(null==e?void 0:e.target)===Be(pe))switch(ke){case K.fail:Ne();break;case K.success:Ie()}}),[Ne,Ie,pe,ke]),Te=u.useCallback((e=>{var a;if(te){const n=ue/e.duration*1e3;0===ue?Ne():ue>=(null!=(a=T.innerWidth)?a:0)?Ie():n>250||se+ue>T.innerWidth/2?fe(K.success):fe(K.fail)}re&&oe(!1)}),[Ne,Ie,ue,se,te,re,T]),Xe=e=>{if(!S||!T)return{};const a=e===ve,n=e===pe;if(!a&&!n||ke)return{};let i=`${ue}px`,t=100*ue/T.innerWidth/2-50+"%",l=.3*(T.innerWidth-ue)/T.innerWidth;return ke?a?{boxShadow:`-2px 0 12px rgba(0, 0, 0, ${l})`}:{}:n?{transform:`translate3d(${t}, 0, 0)`,WebkitTransform:`translate3d(${t}, 0, 0)`}:a?{transform:`translate3d(${i}, 0, 0)`,WebkitTransform:`translate3d(${i}, 0, 0)`,boxShadow:`-2px 0 12px rgba(0, 0, 0, ${l})`}:{}};return u.useEffect((()=>{if(ge&&ge!==n&&!Ve&&!he){const e=u.Children.toArray(C).map((e=>B(e.props))).find((e=>e===ge||e===n))===n;I.current[ge]=null==A?void 0:A.getScroll().y,ye?Pe(ge,e):(V(X),G([ge,n]),ae(ge),ie(n),Q(null),q(!0),Y(e),j.supported||We.set())}if(ge&&ge!==n&&Ve){const e=n,a=ge;Se&&(I.current[Se]=0),de(null),we(null),le(!1),fe(null),ce(0),_e(0),Q(e),G([e]),N.current=()=>{null!==e&&(null==A||A.scrollTo(0,I.current[e])),Ce&&Ce({isBack:!0,from:a,to:e})}}!xe&&ke&&je(Be(pe),Me,F===m.IOS?600:300),xe!==K.fail||ke||null===J||null==A||A.scrollTo(0,I.current[J]),ge!==n&&me&&(be(!1),ie(null),ae(null),q(!1),G([n]),Q(n))}),[n,J,We,me,C,ye,X,Pe,_,Oe,F,ge,he,Ce,Se,xe,Ve,A,pe,ke,te,Me,je]),u.createElement(h,s(o({Component:"section"},y),{className:x(L.View,F===m.IOS&&x(L["View--ios"],"vkuiInternalView--ios"),!ye&&Z&&L["View--animated"],!ye&&te&&L["View--swiping-back"],ye&&L["View--no-motion"],O),onMoveX:e=>{if(!(F!==m.IOS||re||function(e){var a;const n=e.originalEvent.target;return Boolean(null==(a=null==n?void 0:n.closest)?void 0:a.call(n,"input, textarea, [data-vkui-swipe-back=false]"))}(e)||ye))if(null==H?void 0:H.isWebView){if(r&&!(Z&&e.startX<=70)){if(!te&&e.startX<=70&&i&&i.length>1){if(_){if("prevent"===_(J))return void oe(!0)}null!==J&&(V(X),I.current[J]=null==A?void 0:A.getScroll().y),le(!0),ce(e.startX),de(J),we(i.slice(-2)[0])}if(te){let a=0;a=e.shiftX<0?0:e.shiftX>T.innerWidth-se?T.innerWidth:e.shiftX,_e(a)}}}else(e.startX<=70||e.startX>=T.innerWidth-70)&&!me&&be(!0)},onEnd:Te}),u.createElement("div",{className:L.View__panels},Oe.map((e=>{var a;const n=B(e.props),i=Z&&n===(U?ee:ne),t=n===ee||n===ve||n===pe||n===ne&&U;return u.createElement("div",{className:x(L.View__panel,n===J&&L["View__panel--active"],n===ee&&L["View__panel--prev"],n===ne&&L["View__panel--next"],n===ve&&L["View__panel--swipe-back-prev"],n===pe&&L["View__panel--swipe-back-next"],ke===K.success&&L["View__panel--swipe-back-success"],ke===K.fail&&L["View__panel--swipe-back-failed"]),onAnimationEnd:i?Ee:void 0,ref:e=>void 0!==n&&(M.current[n]=e),style:Xe(n),key:n},u.createElement("div",{className:L["View__panel-in"],style:{marginTop:t?-(null!=(a=I.current[n])?a:0):void 0}},u.createElement(z,{entering:n===ne||n===pe},e)))}))))},q=e=>{var a=e,{label:n,"aria-label":i="Назад",className:t}=a,l=c(a,["label","aria-label","className"]);const r=f(),{sizeX:_="none"}=C(),p=r===m.VKCOM||r===m.IOS;let w=u.createElement(X,null);switch(r){case m.IOS:w=u.createElement(A,null);break;case m.VKCOM:w=u.createElement(H,null)}return u.createElement(M,s(o({},l),{className:x(_===O.COMPACT&&T["PanelHeaderBack--sizeX-compact"],r===m.IOS&&T["PanelHeaderBack--ios"],r===m.VKCOM&&T["PanelHeaderBack--vkcom"],p&&!!n&&T["PanelHeaderBack--has-label"],t),label:p&&n,"aria-label":i}),w)},D=({title:e})=>{const a=y();return N.jsx(I,{before:N.jsx(q,{onClick:()=>a.back()}),children:e})};export{D as P,Z as V};
